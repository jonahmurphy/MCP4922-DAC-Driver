 /*
 * Copyright (C) 2012  Jonah Murphy
 *
 *	This program is free software; you can redistribute it and/or
 *	modify it under the terms of the GNU General Public License
 *	as published by the Free Software Foundation; either version 2
 *	of the License, or (at your option) any later version.
 *	
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *	GNU General Public License for more details.
 *	
 *	You should have received a copy of the GNU General Public License
 *	along with this program; if not, write to the Free Software
 *	Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */

/*****************************************************************************************//**
*
*     @file MCP4992_DriverTest.h
*    @brief Test program for MCP4992 DAC Driver for NXP P89V51RD2 -8051, Generates a sine wave...
* @compiler Keil C51
*  @version 0.1
*   @author Jonah Murphy
*     @date 26-05-10
**********************************************************************************************/

#include "t89c51rd2.h"
#include "MCP4922_DAC_driver.h"

#define SINE_LUT_LENGTH 512

int code sine_lut[SINE_LUT_LENGTH] =
{
	0x0200,0x0206,0x020c,0x0212,0x0219,0x021f,0x0225,0x022c,0x0232,0x0238,0x023e,0x0245,0x024b,0x0251,0x0257,0x025d,
	0x0264,0x026a,0x0270,0x0276,0x027c,0x0282,0x0288,0x028e,0x0294,0x029a,0x02a0,0x02a6,0x02ac,0x02b2,0x02b8,0x02be,
	0x02c4,0x02ca,0x02cf,0x02d5,0x02db,0x02e0,0x02e6,0x02ec,0x02f1,0x02f7,0x02fc,0x0302,0x0307,0x030d,0x0312,0x0317,
	0x031c,0x0322,0x0327,0x032c,0x0331,0x0336,0x033b,0x0340,0x0345,0x034a,0x034e,0x0353,0x0358,0x035d,0x0361,0x0366,
	0x036a,0x036f,0x0373,0x0377,0x037b,0x0380,0x0384,0x0388,0x038c,0x0390,0x0394,0x0398,0x039b,0x039f,0x03a3,0x03a6,
	0x03aa,0x03ad,0x03b1,0x03b4,0x03b7,0x03ba,0x03be,0x03c1,0x03c4,0x03c6,0x03c9,0x03cc,0x03cf,0x03d1,0x03d4,0x03d7,
	0x03d9,0x03db,0x03de,0x03e0,0x03e2,0x03e4,0x03e6,0x03e8,0x03ea,0x03ec,0x03ed,0x03ef,0x03f0,0x03f2,0x03f3,0x03f5,
	0x03f6,0x03f7,0x03f8,0x03f9,0x03fa,0x03fb,0x03fc,0x03fd,0x03fd,0x03fe,0x03fe,0x03ff,0x03ff,0x03ff,0x03ff,0x03ff,
	0x03ff,0x03ff,0x03ff,0x03ff,0x03ff,0x03fe,0x03fe,0x03fd,0x03fd,0x03fc,0x03fb,0x03fb,0x03fa,0x03f9,0x03f8,0x03f7,
	0x03f5,0x03f4,0x03f3,0x03f1,0x03f0,0x03ee,0x03ec,0x03eb,0x03e9,0x03e7,0x03e5,0x03e3,0x03e1,0x03df,0x03dc,0x03da,
	0x03d8,0x03d5,0x03d3,0x03d0,0x03cd,0x03cb,0x03c8,0x03c5,0x03c2,0x03bf,0x03bc,0x03b9,0x03b6,0x03b2,0x03af,0x03ab,
	0x03a8,0x03a4,0x03a1,0x039d,0x0399,0x0396,0x0392,0x038e,0x038a,0x0386,0x0382,0x037e,0x0379,0x0375,0x0371,0x036c,
	0x0368,0x0363,0x035f,0x035a,0x0356,0x0351,0x034c,0x0347,0x0342,0x033d,0x0339,0x0334,0x032e,0x0329,0x0324,0x031f,
	0x031a,0x0315,0x030f,0x030a,0x0304,0x02ff,0x02fa,0x02f4,0x02ef,0x02e9,0x02e3,0x02de,0x02d8,0x02d2,0x02cc,0x02c7,
	0x02c1,0x02bb,0x02b5,0x02af,0x02a9,0x02a3,0x029d,0x0297,0x0291,0x028b,0x0285,0x027f,0x0279,0x0273,0x026d,0x0267,
	0x0260,0x025a,0x0254,0x024e,0x0248,0x0241,0x023b,0x0235,0x022f,0x0228,0x0222,0x021c,0x0216,0x020f,0x0209,0x0203,
	0x01fc,0x01f6,0x01f0,0x01e9,0x01e3,0x01dd,0x01d7,0x01d0,0x01ca,0x01c4,0x01be,0x01b7,0x01b1,0x01ab,0x01a5,0x019f,
	0x0198,0x0192,0x018c,0x0186,0x0180,0x017a,0x0174,0x016e,0x0168,0x0162,0x015c,0x0156,0x0150,0x014a,0x0144,0x013e,
	0x0138,0x0133,0x012d,0x0127,0x0121,0x011c,0x0116,0x0110,0x010b,0x0105,0x0100,0x00fb,0x00f5,0x00f0,0x00ea,0x00e5,
	0x00e0,0x00db,0x00d6,0x00d1,0x00cb,0x00c6,0x00c2,0x00bd,0x00b8,0x00b3,0x00ae,0x00a9,0x00a5,0x00a0,0x009c,0x0097,
	0x0093,0x008e,0x008a,0x0086,0x0081,0x007d,0x0079,0x0075,0x0071,0x006d,0x0069,0x0066,0x0062,0x005e,0x005b,0x0057,
	0x0054,0x0050,0x004d,0x0049,0x0046,0x0043,0x0040,0x003d,0x003a,0x0037,0x0034,0x0032,0x002f,0x002c,0x002a,0x0027,
	0x0025,0x0023,0x0020,0x001e,0x001c,0x001a,0x0018,0x0016,0x0014,0x0013,0x0011,0x000f,0x000e,0x000c,0x000b,0x000a,
	0x0008,0x0007,0x0006,0x0005,0x0004,0x0004,0x0003,0x0002,0x0002,0x0001,0x0001,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0001,0x0001,0x0002,0x0002,0x0003,0x0004,0x0005,0x0006,0x0007,0x0008,0x0009,
	0x000a,0x000c,0x000d,0x000f,0x0010,0x0012,0x0013,0x0015,0x0017,0x0019,0x001b,0x001d,0x001f,0x0021,0x0024,0x0026,
	0x0028,0x002b,0x002e,0x0030,0x0033,0x0036,0x0039,0x003b,0x003e,0x0041,0x0045,0x0048,0x004b,0x004e,0x0052,0x0055,
	0x0059,0x005c,0x0060,0x0064,0x0067,0x006b,0x006f,0x0073,0x0077,0x007b,0x007f,0x0084,0x0088,0x008c,0x0090,0x0095,
	0x0099,0x009e,0x00a2,0x00a7,0x00ac,0x00b1,0x00b5,0x00ba,0x00bf,0x00c4,0x00c9,0x00ce,0x00d3,0x00d8,0x00dd,0x00e3,
	0x00e8,0x00ed,0x00f2,0x00f8,0x00fd,0x0103,0x0108,0x010e,0x0113,0x0119,0x011f,0x0124,0x012a,0x0130,0x0135,0x013b,
	0x0141,0x0147,0x014d,0x0153,0x0159,0x015f,0x0165,0x016b,0x0171,0x0177,0x017d,0x0183,0x0189,0x018f,0x0195,0x019b,
	0x01a2,0x01a8,0x01ae,0x01b4,0x01ba,0x01c1,0x01c7,0x01cd,0x01d3,0x01da,0x01e0,0x01e6,0x01ed,0x01f3,0x01f9,0x01ff
};


void main()
{
    int i;
	
    MCP4922_init();
	
    while(1){
        for(i = 0; i < SINE_LUT_LENGTH; i++){
            MCP4922_DAC_A_TX_word( sine_lut[i], 1, 1);
        }
    }
}